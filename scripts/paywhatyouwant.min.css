function pwywMsgDialog(a){jQuery(".pwyw_spinner_container").css("display","none");jQuery(".pwyw_error_container").css("display","block");jQuery(".pwyw_error_message").text(a);console.log("DLGMSG: "+a);pwywCenterMsgDialog()}function pwywHideMsgDialog(a){jQuery(".pwyw_error_container").css("display","none")}function pwywCenterMsgDialog(){wz=(jQuery(window).width()-jQuery(".pwyw_error_box").outerWidth())/2,hz=(jQuery(window).height()-jQuery(".pwyw_error_box").outerHeight())/2;jQuery(".pwyw_error_box").css({position:"fixed",margin:0,left:wz,top:hz})}function pwywCenterSpinner(){wz1=(jQuery(window).width()-jQuery(".pwyw_spinner_box").outerWidth())/2,hz1=(jQuery(window).height()-jQuery(".pwyw_spinner_box").outerHeight())/2;wz2=(jQuery(window).width()-jQuery(".pwyw_spinner_msg").outerWidth())/2,hz2=(jQuery(window).height()-jQuery(".pwyw_spinner_msg").outerHeight())/2;jQuery(".pwyw_spinner_box").css({position:"fixed",margin:0,left:wz1,top:hz1});jQuery(".pwyw_spinner_msg").css({position:"fixed",margin:0,left:wz2+40,top:hz2+66})}function pwywShowSpinner(){jQuery(".pwyw_error_container").css("display","none");jQuery(".pwyw_spinner_container").css("display","block");pwywCenterSpinner()}function pwywHideSpinner(){jQuery(".pwyw_spinner_container").css("display","none")}function pwyw_add_variation_to_cart(b){var c=0;var d=0;var c=jQuery("#pwyw_input_pay_amount_"+b).maskMoney("unmasked")[0];if(c==null||c=="undefined"){c=jQuery("#pwyw_input_pay_amount_store_"+b).maskMoney("unmasked")[0]}if(c==null||c=="undefined"){c=jQuery("select.pwyw_sku_value").data("amount")}d=parseFloat(c);var a=jQuery(".pwyw_sku_value  option:selected").data("product_id");var f=jQuery("input[type=number].input-text.qty.text").val();if(f==null){f=1}var e={action:"wc_pay_what_you_want_add_to_cart",wc_pay_what_you_want_pid:b,wc_pay_what_you_want_qty:f,wc_pay_what_you_want_amt:d.toFixed(2),wc_pay_what_you_want_vri:a};pwywShowSpinner();jQuery.post(ajaxurl,e,function(h){var g=h.charAt(h.length-1);var i=h;if(g=="0"){i=i.substring(0,i.length-1)}if(i==null||i==""||i=="undefined"){pwywMsgDialog("SERVER_ERROR: Server returns empty string.");pwywHideSpinner();console.log("SERVER_ERROR: "+i)}else{if(h.indexOf("ERROR")>-1){pwywMsgDialog(i);pwywHideSpinner();console.log("SERVER_ERROR: "+i)}else{pwywHideSpinner();console.log("SERVER_RETURNS:"+i);window.location=i}}})}function pwyw_add_to_cart(a){var b=jQuery("#pwyw_input_pay_amount_"+a).maskMoney("unmasked")[0];if(b==null||b=="undefined"){b=jQuery("#pwyw_input_pay_amount_store_"+a).maskMoney("unmasked")[0]}if(b==null||b=="undefined"){b=jQuery("input.single_add_to_cart_button.button.alt.pwyw_price_input").data("amount")}var c=parseFloat(b);var e=jQuery("input[type=number].input-text.qty.text").val();if(e==null){e=1}var d={action:"wc_pay_what_you_want_add_to_cart",wc_pay_what_you_want_pid:a,wc_pay_what_you_want_qty:e,wc_pay_what_you_want_amt:c.toFixed(2),wc_pay_what_you_want_vri:0};pwywShowSpinner();jQuery.post(ajaxurl,d,function(g){var f=g.charAt(g.length-1);var h=g;if(f=="0"){h=h.substring(0,h.length-1)}if(h==null||h==""||h=="undefined"){pwywMsgDialog("SERVER_ERROR: Server returns empty string.");pwywHideSpinner();console.log("SERVER_ERROR: "+h)}else{if(g.indexOf("ERROR")>-1){pwywMsgDialog(h);pwywHideSpinner();console.log("SERVER_ERROR: "+h)}else{pwywHideSpinner();console.log("SERVER_RETURNS:"+h);window.location=h}}})}(function(a){a(document).ready(function(){var i=a(document).closest(".variations_form");var e=a(document).find(".product_meta_pwyw").find(".sku");var d=a(document).find("#main .woocommerce-main-image img");var n=a(".variations_form").data("product_variations");d.attr("src",l("image"));e.text(l("sku"));if(h()){j()}else{if(p()){o(k(),b())}else{f(b())}}a("div.quantity:not(.buttons_added), td.quantity:not(.buttons_added)").addClass("buttons_added").append('<input type="button" value="+" class="plus" />').prepend('<input type="button" value="-" class="minus" />');a(".woocommerce-ordering").on("change","select.orderby",function(){a(this).closest("form").submit()});a("input.qty:not(.product-quantity input.qty)").each(function(){var r=parseFloat(a(this).attr("min"));if(r&&r>0&&parseFloat(a(this).val())<r){a(this).val(r)}});a(document).on("click",".plus, .minus",function(){var s=a(this).closest(".quantity").find(".qty");var t=parseFloat(s.val());var r=parseFloat(s.attr("max"));var u=parseFloat(s.attr("min"));var w=s.attr("step");var y=q();var v=g();if(v<1){v=5555}if(y!="Nan"&&y!=""&&y>0){u=y}if(v!="Nan"&&v!=""&&v>0){r=v}if(!t||t===""||t==="NaN"){t=0}if(r===""||r==="NaN"){r=""}if(u===""||u==="NaN"){u=0}if(w==="any"||w===""||w===undefined||parseFloat(w)==="NaN"){w=1}if(a(this).is(".plus")){if(r&&(r==t||t>r||t>v)){s.val(r)}else{var x=t+parseFloat(w);if(x>v||x>r){s.val(r)}else{s.val(x)}}}else{if(u&&(u==t||t<u||t<y)){s.val(u)}else{if(t>0){var x=t-parseFloat(w);if(x<y||x<u){s.val(u)}else{s.val(x)}}}}s.trigger("change")});a("#pwyw_cancel_dialog").click(function(){pwywHideMsgDialog()});function q(){return parseFloat(l("min"))}function g(){return parseFloat(l("max"))}a(document).on("change",".pwyw_sku_value",function(){var r=a(document).find(".quantity").find(".qty");var v=l("sku");var s=l("image");var t=parseFloat(r.attr("min"));var u=q();if(u!="Nan"&&u!=""&&u>0){t=u}if(v=="undefined"){v="N/A"}if(h()){j()}else{if(p()){o(k(),b())}else{f(b())}}e.text(v);d.attr("src",s);r.val(t)});function l(r){return a(".pwyw_sku_value  option:selected").data(r)}function h(){return true}function p(){var r=l("sales");var s=parseFloat(r).toFixed(2);if(s!="Nan"&&r!="undefined"&&s>0){return true}return false}function k(){var r=a(".pwyw_sku_value  option:selected").data("d_sales");return r}function m(){var r=a(".pwyw_sku_value  option:selected").data("sales");return r}function b(){var r=a(".pwyw_sku_value  option:selected").data("d_price");return r}function c(){var r=a(".pwyw_sku_value  option:selected").data("price");return r}function o(v,u){var r=a(document).find(".single_variation").find("span.span_price");var t=a(document).find(".single_variation").find("ins");var s=a(document).find(".single_variation").find("del");r.css("display","none");s.css("display","block");t.css("display","block");t.html(v);s.html(u)}function j(){var r=a(document).find(".single_variation").find("span.span_price");var t=a(document).find(".single_variation").find("ins");var s=a(document).find(".single_variation").find("del");r.css("display","block");s.css("display","none");t.css("display","none")}function f(u){var r=a(document).find(".single_variation").find("span.span_price");var t=a(document).find(".single_variation").find("ins");var s=a(document).find(".single_variation").find("del");r.css("display","block");s.css("display","none");t.css("display","none");r.html(u);r.html(u)}});a(window).resize(function(){pwywCenterSpinner();pwywCenterMsgDialog()})})(window.jQuery);